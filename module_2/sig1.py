#!/usr/bin/env python
""" Simple single client echo server in python"""
import socket
import sys
import signal
import getopt

opts,args=getopt.getopt(sys.argv[1:],"s:",['time'])

for opt,arg in opts:
    if opt =="-s":
        time=int(arg)
        

def alarmHandler(signal,frm):
    print("Alarm recieved shutting down")
    sys.exit()

signal.signal(signal.SIGALRM,alarmHandler)
signal.alarm(time)

while True:
    try:
        HOST ="10.0.2.15"
        PORT =5656
    except:
        print(" ./filename.py [HOST IP] [HOST PORT]")

    echosocket=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    echosocket.bind((HOST,PORT))
    echosocket.setsockopt(socket.SOL_SOCKET,socket.SO_REUSEADDR,1)
    echosocket.listen(5)

    client,addr=echosocket.accept()

    msg='dummy'

    while len(msg):
        msg=client.recv(1024).decode('utf-8')
        print(msg)
        client.send(msg.encode())

    client.close()




